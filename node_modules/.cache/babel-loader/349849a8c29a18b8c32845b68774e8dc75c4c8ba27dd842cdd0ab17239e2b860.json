{"ast":null,"code":"import { ref } from 'vue';\nimport { Edit } from '@element-plus/icons-vue';\nimport axiosUtil from '@/util/axios';\nimport { ElMessage } from 'element-plus';\nimport router from \"@/router\";\nexport default {\n  __name: 'index',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const form = ref({\n      userName: '',\n      password: ''\n    });\n    const rules = ref({\n      userName: [{\n        required: true,\n        message: '请输入用户名',\n        trigger: 'blur'\n      }],\n      password: [{\n        required: true,\n        message: '请输入密码',\n        trigger: 'blur'\n      }]\n    });\n    const formRef = ref(null);\n    const handleLogin = () => {\n      formRef.value.validate(async valid => {\n        if (valid) {\n          try {\n            // 向后端发起登录请求\n            let result = await axiosUtil.post(\"/api/userinfo/login\", form.value);\n            let data = result.data;\n            if (data.success === true) {\n              // 将返回的token和用户名存储在浏览器sessionStorage中\n              window.sessionStorage.setItem(\"token\", data.data.userinfo.token);\n              window.sessionStorage.setItem(\"userName\", data.data.userinfo.userName);\n              window.sessionStorage.setItem(\"userId\", data.data.userinfo.id);\n              // 跳转至首页\n              router.replace(\"/home\");\n              ElMessage.success(\"登录成功\");\n            } else {\n              ElMessage.error(result.msg);\n            }\n          } catch (err) {\n            console.log(\"error:\" + err);\n            ElMessage.error(\"系统错误，请联系管理员\");\n          }\n        } else {\n          console.log(\"验证失败\");\n        }\n      });\n    };\n    const __returned__ = {\n      form,\n      rules,\n      formRef,\n      handleLogin,\n      ref,\n      get Edit() {\n        return Edit;\n      },\n      get axiosUtil() {\n        return axiosUtil;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get router() {\n        return router;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","Edit","axiosUtil","ElMessage","router","form","userName","password","rules","required","message","trigger","formRef","handleLogin","value","validate","valid","result","post","data","success","window","sessionStorage","setItem","userinfo","token","id","replace","error","msg","err","console","log"],"sources":["D:/vue_project/survey-vue/src/views/login/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"login-container\">\r\n      <el-form class=\"login-form\"\r\n               :model=\"form\" :rules=\"rules\" ref=\"formRef\">\r\n          <div class=\"title-container\">\r\n              <h3 class=\"title\">微校园</h3>\r\n          </div>\r\n          <el-form-item prop=\"username\">\r\n              <el-icon :size=\"20\" class=\"svg-container\"><Edit/></el-icon>\r\n              <el-input v-model=\"form.userName\" placeholder=\"请输入用户名\"/>\r\n          </el-form-item>\r\n          <el-form-item prop=\"password\">\r\n              <el-icon :size=\"20\" class=\"svg-container\"><Edit/></el-icon>\r\n              <el-input v-model=\"form.password\" type=\"password\" placeholder=\"请输入密码\"/>\r\n          </el-form-item>\r\n          <el-form-item>\r\n              <el-button type=\"primary\" class=\"login-button\" @click=\"handleLogin\">登录</el-button>\r\n          </el-form-item>\r\n      </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref} from 'vue';\r\nimport {Edit} from '@element-plus/icons-vue';\r\nimport axiosUtil from '@/util/axios'\r\nimport {ElMessage} from 'element-plus';\r\nimport router from \"@/router\";\r\n\r\nconst form = ref({\r\n    userName: '',\r\n    password: ''\r\n});\r\nconst rules = ref({\r\n    userName: [\r\n        {required: true, message: '请输入用户名', trigger: 'blur'}\r\n    ],\r\n    password: [\r\n        {required: true, message: '请输入密码', trigger: 'blur'}\r\n    ],\r\n});\r\nconst formRef = ref(null);\r\nconst handleLogin = () => {\r\n    formRef.value.validate(async (valid) => {\r\n        if (valid) {\r\n            try {\r\n                // 向后端发起登录请求\r\n                let result = await axiosUtil.post(\"/api/userinfo/login\", form.value);\r\n                let data = result.data;\r\n                if (data.success === true) {\r\n                    // 将返回的token和用户名存储在浏览器sessionStorage中\r\n                    window.sessionStorage.setItem(\"token\", data.data.userinfo.token);\r\n                    window.sessionStorage.setItem(\"userName\", data.data.userinfo.userName);\r\n                    window.sessionStorage.setItem(\"userId\", data.data.userinfo.id);\r\n                    // 跳转至首页\r\n                    router.replace(\"/home\");\r\n                    ElMessage.success(\"登录成功\");\r\n                } else {\r\n                    ElMessage.error(result.msg);\r\n                }\r\n            } catch (err) {\r\n                console.log(\"error:\"+err);\r\n                ElMessage.error(\"系统错误，请联系管理员\");\r\n            }\r\n        } else {\r\n            console.log(\"验证失败\")\r\n        }\r\n    });\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n$bg: #2d3a4b;\r\n$dark_gray: #889aa4;\r\n$light_gray: #eee;\r\n$cursor: #fff;\r\n.login-container {\r\n    min-height: 100%;\r\n    width: 100%;\r\n    background-color: $bg;\r\n    overflow: hidden;\r\n    .login-form {\r\n        position: relative;\r\n        width: 520px;\r\n        max-width: 100%;\r\n        padding: 160px 35px 0;\r\n        margin: 0 auto;\r\n        overflow: hidden;\r\n        ::v-deep .el-form-item {\r\n            border: 1px solid rgba(255, 255, 255, 0.1);\r\n            background: rgba(0, 0, 0, 0.1);\r\n            border-radius: 5px;\r\n            color: #454545;\r\n        }\r\n        ::v-deep .el-form-item__content{\r\n            color: #454545;\r\n            background: rgba(0, 0, 0, 0.1);\r\n        }\r\n        ::v-deep .el-input__wrapper {\r\n            display: block;\r\n            color: #454545;\r\n            background: rgb(36,47,60);\r\n            box-shadow:none;\r\n            height: 95%;\r\n        }\r\n        ::v-deep .el-input {\r\n            display: inline-block;\r\n            background: rgb(36,47,60);\r\n            height: 47px;\r\n            width: 85%;\r\n            input {\r\n                background: transparent;\r\n                border: 0px;\r\n                -webkit-appearance: none;\r\n                border-radius: 0px;\r\n                padding: 12px 5px 12px 15px;\r\n                color: $light_gray;\r\n                height: 47px;\r\n                caret-color: $cursor;\r\n            }\r\n        }\r\n        .login-button {\r\n            width: 100%;\r\n            box-sizing: border-box;\r\n        }\r\n    }\r\n    .tips {\r\n        font-size: 16px;\r\n        line-height: 28px;\r\n        color: #fff;\r\n        margin-bottom: 10px;\r\n        span {\r\n            &:first-of-type {\r\n                margin-right: 16px;\r\n            }\r\n        }\r\n    }\r\n    .svg-container {\r\n        padding: 6px 5px 6px 15px;\r\n        color: $dark_gray;\r\n        vertical-align: middle;\r\n        display: inline-block;\r\n    }\r\n    .title-container {\r\n        position: relative;\r\n        .title {\r\n            font-size: 26px;\r\n            color: $light_gray;\r\n            margin: 0px auto 40px auto;\r\n            text-align: center;\r\n            font-weight: bold;\r\n        }\r\n        ::v-deep .lang-select {\r\n            position: absolute;\r\n            top: 4px;\r\n            right: 0;\r\n            background-color: white;\r\n            font-size: 22px;\r\n            padding: 4px;\r\n            border-radius: 4px;\r\n            cursor: pointer;\r\n        }\r\n    }\r\n    .show-pwd {\r\n        font-size: 16px;\r\n        color: $dark_gray;\r\n        cursor: pointer;\r\n        user-select: none;\r\n    }\r\n}\r\n</style>"],"mappings":"AAuBA,SAAQA,GAAG,QAAO,KAAK;AACvB,SAAQC,IAAI,QAAO,yBAAyB;AAC5C,OAAOC,SAAS,MAAM,cAAc;AACpC,SAAQC,SAAS,QAAO,cAAc;AACtC,OAAOC,MAAM,MAAM,UAAU;;;;;;;IAE7B,MAAMC,IAAI,GAAGL,GAAG,CAAC;MACbM,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE;IACd,CAAC,CAAC;IACF,MAAMC,KAAK,GAAGR,GAAG,CAAC;MACdM,QAAQ,EAAE,CACN;QAACG,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,QAAQ;QAAEC,OAAO,EAAE;MAAM,CAAC,CACvD;MACDJ,QAAQ,EAAE,CACN;QAACE,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,OAAO;QAAEC,OAAO,EAAE;MAAM,CAAC;IAE3D,CAAC,CAAC;IACF,MAAMC,OAAO,GAAGZ,GAAG,CAAC,IAAI,CAAC;IACzB,MAAMa,WAAW,GAAGA,CAAA,KAAM;MACtBD,OAAO,CAACE,KAAK,CAACC,QAAQ,CAAC,MAAOC,KAAK,IAAK;QACpC,IAAIA,KAAK,EAAE;UACP,IAAI;YACA;YACA,IAAIC,MAAM,GAAG,MAAMf,SAAS,CAACgB,IAAI,CAAC,qBAAqB,EAAEb,IAAI,CAACS,KAAK,CAAC;YACpE,IAAIK,IAAI,GAAGF,MAAM,CAACE,IAAI;YACtB,IAAIA,IAAI,CAACC,OAAO,KAAK,IAAI,EAAE;cACvB;cACAC,MAAM,CAACC,cAAc,CAACC,OAAO,CAAC,OAAO,EAAEJ,IAAI,CAACA,IAAI,CAACK,QAAQ,CAACC,KAAK,CAAC;cAChEJ,MAAM,CAACC,cAAc,CAACC,OAAO,CAAC,UAAU,EAAEJ,IAAI,CAACA,IAAI,CAACK,QAAQ,CAAClB,QAAQ,CAAC;cACtEe,MAAM,CAACC,cAAc,CAACC,OAAO,CAAC,QAAQ,EAAEJ,IAAI,CAACA,IAAI,CAACK,QAAQ,CAACE,EAAE,CAAC;cAC9D;cACAtB,MAAM,CAACuB,OAAO,CAAC,OAAO,CAAC;cACvBxB,SAAS,CAACiB,OAAO,CAAC,MAAM,CAAC;YAC7B,CAAC,MAAM;cACHjB,SAAS,CAACyB,KAAK,CAACX,MAAM,CAACY,GAAG,CAAC;YAC/B;UACJ,CAAC,CAAC,OAAOC,GAAG,EAAE;YACVC,OAAO,CAACC,GAAG,CAAC,QAAQ,GAACF,GAAG,CAAC;YACzB3B,SAAS,CAACyB,KAAK,CAAC,aAAa,CAAC;UAClC;QACJ,CAAC,MAAM;UACHG,OAAO,CAACC,GAAG,CAAC,MAAM,CAAC;QACvB;MACJ,CAAC,CAAC;IACN,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}